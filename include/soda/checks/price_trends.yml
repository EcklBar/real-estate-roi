# Data quality checks for agg_price_trends table
checks for agg_price_trends:
  # Table must not be empty
  - row_count > 0:
      name: Price trends table is not empty

  # Settlement price should be positive when present
  - invalid_count(settlement_price) = 0:
      name: Settlement prices are valid
      valid min: 0

  # Country price should be positive when present
  - invalid_count(country_price) = 0:
      name: Country prices are valid
      valid min: 0

  # Year should be reasonable (2008-2030)
  - invalid_count(trend_year) = 0:
      name: Trend years are in valid range
      valid min: 2008
      valid max: 2030

  # Month should be 1-12
  - invalid_count(trend_month) = 0:
      name: Trend months are valid
      valid min: 1
      valid max: 12

  # Settlement ID should not be null
  - missing_count(settlement_id) = 0:
      name: No missing settlement IDs

  # No duplicate records
  - duplicate_count(settlement_id, neighborhood_id, trend_year, trend_month, num_rooms) = 0:
      name: No duplicate trend records
